<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://openvoiceos.github.io/ovos-technical-manual/620-universal_skills/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Universal Skills - OVOS Technical Manual</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Universal Skills";
        var mkdocs_page_input_path = "620-universal_skills.md";
        var mkdocs_page_url = "/ovos-technical-manual/620-universal_skills/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> OVOS Technical Manual
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Home</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="..">Introduction</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Getting Started</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../50-ovos_installer/">ovos-installer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../001-release_channels/">Manual Install</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RaspOVOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../51-install_raspovos/">Tutorial</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../54-skill-examples/">Default Skills</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../55-raspovos_troubleshooting/">Troubleshooting</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Language Support</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../lang_support/">Translations</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gitlocalize_tutorial/">GitLocalize Tutorial</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Architecture</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../99-architecture-overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../100-bus_service/">Bus</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../101-speech_service/">Listener</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../102-core/">Core</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../399-intents/">Skills and Intents</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../103-audio_service/">Audio</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../104-gui_service/">GUI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../340-PHAL/">Platform/Hardware Abstraction Layer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../300-plugin-manager/">Plugin Manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../110-config/">Configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Intent Pipelines</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../pipelines_overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adapt_pipeline/">Adapt</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../padatious_pipeline/">Padatious</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../m2v_pipeline/">Model2Vec</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../converse_pipeline/">Converse</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../stop_pipeline/">Stop</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../153-persona_pipeline/">Persona</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cq_pipeline/">Common Query</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../631-OCP_pipeline/">OCP</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../fallback_pipeline/">Fallback</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Transformers</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../audio_transformers/">Audio</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../utterance_transformers/">Utterance</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../intent_transformers/">Intents</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../dialog_transformers/">Dialog</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tts_transformers/">TTS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">AI Agents</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../150-personas/">Personas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../151-llm-transformers/">AI Transformers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../150-advanced_solvers/">Specialized Solvers</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Self Hosting</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../202-persona_server/">Persona Server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../152-hivemind-agents/">HiveMind</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../200-stt_server/">STT Server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../201-tts_server/">TTS Server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../203-translate_server/">Translate Server</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Skill Development</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../400-skill-design-guidelines/">Design Guidelines</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../401-skill_structure/">Anatomy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../402-statements/">Dialog</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../403-intents/">Intent Design</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../405-customization/">Customization</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../406-messagebus/">Bus Interaction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../407-skill_filesystem/">Filesystem</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../408-skill_settings/">Skill Settings</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../409-skill_api/">Skill API</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../410-skill_runtime_requirements/">Runtime Requirements</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../411-skill_json/">Skill Json</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../420-ssml/">SSML</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../430-skill_dev_faq/">F.A.Q.</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Continuous Conversation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../500-prompts/">Prompts</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../501-context/">Follow up Questions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../502-converse/">Converse</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../503-layers/">Intent Layers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../504-session/">Session Aware Skills</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Advanced Skill Types</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../600-fallbacks/">Fallback Skills</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../610-common_query/">Common Query Skills</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../630-OCP_skills/">Media Skills</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Universal Skills</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#language-plugins">Language Plugins</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#initialization">Initialization</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#intents-and-utterances">Intents and Utterances</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#universal-intent-handler">Universal Intent Handler</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#englishcatfacts-skill-example">EnglishCatFacts Skill Example</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#spanishdatabase-skill-example">SpanishDatabase Skill Example</a>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">GUI</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../701-gui_protocol/">Protocol</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Voice Apps</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../590-voice_apps/">Standalone Apps</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">MessageBus</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../900-bus_client/">Messagebus Client</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../720-skill_gui/">GUI Interface</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../800-mk1_api/">Enclosure Api</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Plugin Development</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../310-mic_plugins/">Microphone</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../311-vad_plugins/">Voice Activity Detection</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../312-wake_word_plugins/">Wake Word</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../313-stt_plugins/">Speech To Text</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../320-tts_plugins/">Text To Speech</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../321-g2p_plugins/">Grapheme to Phoneme</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../330-transformer_plugins/">Transformers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../350-translation_plugins/">Language Detection/Translation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../370-ocp_plugins/">OCP Stream Extractors</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../371-media_plugins/">Media Playback</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Misc. Utilities</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../891-number_parser/">Number Parser</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../890-date_parser/">Date Parser</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../893-color_parser/">Color Parser</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../910-quebra_frases/">Quebra Frases</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../920-padacioso/">Padacioso</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../801-mk1_utils/">Mark1 Utils</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Misc. Information</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../002-license/">License</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../003-timeline/">Timeline</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">OVOS Technical Manual</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Advanced Skill Types</li>
      <li class="breadcrumb-item active">Universal Skills</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="universalskill">UniversalSkill</h1>
<p>The <code>UniversalSkill</code> class is designed to facilitate automatic translation of input and output messages between different languages. </p>
<p>This skill is particularly useful when native language support is not feasible, providing a convenient way to handle multilingual interactions.</p>
<blockquote>
<p><strong>NEW</strong> - <code>ovos-core</code> version <strong>0.0.8</strong></p>
</blockquote>
<h2 id="overview">Overview</h2>
<p>This skill ensures that intent handlers receive utterances in the skill's internal language and are expected to produce responses in the same internal language. </p>
<p>The <code>speak</code> method, used for generating spoken responses, automatically translates utterances from the internal language to the original query language.</p>
<blockquote>
<p><strong>NOTE:</strong> The <code>self.lang</code> attribute reflects the original query language, while received utterances are always in <code>self.internal_language</code>.</p>
</blockquote>
<h2 id="language-plugins">Language Plugins</h2>
<p>To run <code>UniversalSkills</code> you need to configure <a href="https://openvoiceos.github.io/ovos-technical-manual/lang_plugins.md">Translation plugins</a> in <code>mycroft.conf</code></p>
<pre><code class="language-javascript">  // Translation plugins
  &quot;language&quot;: {
    // by default uses public servers
    // https://github.com/OpenVoiceOS/ovos-translate-server    
    &quot;detection_module&quot;: &quot;ovos-lang-detector-plugin-server&quot;,
    &quot;translation_module&quot;: &quot;ovos-translate-plugin-server&quot;
  },
</code></pre>
<h2 id="usage">Usage</h2>
<h3 id="initialization">Initialization</h3>
<pre><code class="language-python"># Example initialization
from ovos_workshop.skills.auto_translatable import UniversalSkill

class MyMultilingualSkill(UniversalSkill):
    &quot;&quot;&quot;
    Skill that auto translates input/output from any language

    This skill is designed to automatically translate input and output messages
    between different languages. The intent handlers are ensured to receive
    utterances in the skill's internal language, and they are expected to produce
    utterances in the same internal language.

    The `speak` method will always translate utterances from the internal language
    to the original query language (`self.lang`).

    NOTE: `self.lang` reflects the original query language, but received utterances
          are always in `self.internal_language`.
    &quot;&quot;&quot;
    def __init__(self, *args, **kwargs):
        &quot;&quot;&quot;
        Initialize the UniversalSkill.

        Parameters for super():
        - internal_language (str): The language in which the skill internally operates.
        - translate_tags (bool): Whether to translate the private __tags__ value (adapt entities).
        - autodetect (bool): If True, the skill will detect the language of the utterance
                            and ignore self.lang / Session.lang.
        - translate_keys (list): default [&quot;utterance&quot;, &quot;utterances&quot;] 
                                 Keys added here will have values translated in message.data.
        &quot;&quot;&quot;
        # skill hardcoded in portuguese
        super().__init__(internal_language=&quot;pt-pt&quot;, translate_tags=translate_tags,
                         autodetect=autodetect, translate_keys=translate_keys, *args, **kwargs)
</code></pre>
<h3 id="intents-and-utterances">Intents and Utterances</h3>
<p>Use the <code>register_intent</code> and <code>register_intent_file</code> methods to register intents with universal intent handlers. The usual decorators also work</p>
<p>The <code>speak</code> method is used to generate spoken responses.
It automatically translates utterances if the output language is different from the skill's internal language or autodetection is enabled.</p>
<pre><code class="language-python"># Example speaking utterance, hardcoded to self.internal_language
self.speak(&quot;Hello, how are you?&quot;)
</code></pre>
<h3 id="universal-intent-handler">Universal Intent Handler</h3>
<blockquote>
<p><strong>NOTE</strong> Users should NOT use the <code>create_universal_handler</code> method manually in skill intents; it is automatically utilized by <code>self.register_intent</code>. </p>
</blockquote>
<p>The following example demonstrates its usage with <code>self.add_event</code>.</p>
<pre><code class="language-python"># Example universal handler creation
def my_event_handler(message):
    # Your event handling logic here
    pass

# Manual usage with self.add_event
my_handler = self.create_universal_handler(my_event_handler)
self.add_event(&quot;my_event&quot;, my_handler)
</code></pre>
<h2 id="englishcatfacts-skill-example">EnglishCatFacts Skill Example</h2>
<p>Let's create a simple tutorial skill that interacts with an API to fetch cat facts in English. </p>
<p>We'll use the <code>UniversalSkill</code> class to support translations for other languages.</p>
<pre><code class="language-python">from ovos_workshop.skills.auto_translatable import UniversalSkill


class EnglishCatFactsSkill(UniversalSkill):
    def __init__(self, *args, **kwargs):
        &quot;&quot;&quot;
        This skill is hardcoded in english, indicated by internal_language
        &quot;&quot;&quot;
        super().__init__(internal_language=&quot;en-us&quot;, *args, **kwargs)

    def fetch_cat_fact(self):
        # Your logic to fetch a cat fact from an API
        cat_fact = &quot;Cats have five toes on their front paws but only four on their back paws.&quot;
        return cat_fact

    @intent_handler(&quot;cat_fact.intent&quot;)
    def handle_cat_fact_request(self, message):
        # Fetch a cat fact in self.internal_language
        cat_fact = self.fetch_cat_fact()
        # Speak the cat fact, it will be translated to self.lang if needed
        self.speak(cat_fact)
</code></pre>
<p>In this example, the <code>CatFactsSkill</code> class extends <code>UniversalSkill</code>, allowing it to seamlessly translate cat facts into the user's preferred language.</p>
<h2 id="spanishdatabase-skill-example">SpanishDatabase Skill Example</h2>
<p>A more advanced example, let's consider a skill that listens to bus messages.</p>
<p>Our skill listens for messages containing a <code>"phrase"</code> payload in message.data that can be in any language, and it saves this phrase <em>in spanish</em> to a database. 
Then it speaks a hardcoded spanish utterance, and it gets translated into the language of the bus message Session</p>
<pre><code class="language-python">from ovos_workshop.skills.auto_translatable import UniversalSkill

class SpanishDatabaseSkill(UniversalSkill):
    def __init__(self, *args, **kwargs):
        &quot;&quot;&quot;
        This skill is hardcoded in spanish, indicated by internal_language
        &quot;&quot;&quot;
        translate_keys=[&quot;phrase&quot;] # translate &quot;phrase&quot; in message.data
        super().__init__(internal_language=&quot;es-es&quot;,
                         translate_keys=translate_keys,
                         *args, **kwargs)

    def initialize(self):
        # wrap the event into a auto translation layer
        handler = self.create_universal_handler(self.handle_entry)
        self.add_event(&quot;skill.database.add&quot;, handler)

    def handle_entry(self, message: Message):
        phrase = message.data[&quot;phrase&quot;]  # assured to be in self.internal_language

        # Your logic to save phrase to a database

        self.speak(&quot;agregado a la base de datos&quot;) # will be spoken in self.lang
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../630-OCP_skills/" class="btn btn-neutral float-left" title="Media Skills"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../701-gui_protocol/" class="btn btn-neutral float-right" title="Protocol">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../630-OCP_skills/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../701-gui_protocol/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../javascripts/analytics.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
